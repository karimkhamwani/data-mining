xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
caravan_insurance$MOSHOOFD
# caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
caravan_insurance$MAANTHUI
# caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
caravan_insurance$MAANTHUI
# caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
# caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
# caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
caravan_insurance
# caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
# caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
# caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance)
# caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
# caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
# caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
# reading file
caravan_insurance = readr::read_csv("caravan-insurance-challenge.csv")
head(caravan_insurance)
# training data
caravan_insurance_train = (caravan_insurance[caravan_insurance$ORIGIN == "train",])
#testing data
caravan_insurance_test = (caravan_insurance[caravan_insurance$ORIGIN == "test",])
# reading file
caravan_insurance = readr::read_csv("caravan-insurance-challenge.csv")
head(caravan_insurance,10)
# training data
caravan_insurance_train = (caravan_insurance[caravan_insurance$ORIGIN == "train",])
#testing data
caravan_insurance_test = (caravan_insurance[caravan_insurance$ORIGIN == "test",])
library(ggplot2)
library(plyr)
head(caravan_insurance,10)
unInsuredRows = caravan_insurance[caravan_insurance$CARAVAN == 0,]
insuredRows = caravan_insurance[caravan_insurance$CARAVAN == 1,]
df =
peopleNotInsuredWithCaravan  <- nrow(unInsuredRows);
peopleInsuredWithCaravan = nrow(insuredRows);
ratioOfPeopleWhoDontBought = peopleNotInsuredWithCaravan/totalRows * 100
ratioOfPeopleWhoBought = peopleInsuredWithCaravan/totalRows * 100
# 5.96% who bought insurance vs 94% who didn't buy the insurance, by statistics it looks like company is in loss people are not interested in buying they have to something to improve.
dat <- data.frame(
policy_status = factor(c("Not Insured","Insured"), levels=c("Not Insured","Insured")),
Count = c( peopleNotInsuredWithCaravan , peopleInsuredWithCaravan)
)
ggplot(data=dat, aes(x=policy_status, y=Count, fill=policy_status)) +
geom_bar(colour="red", stat="identity")
head(caravan_insurance,10)
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
head(caravan_insurance)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
# caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
# caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
head(caravan_insurance,10)
# caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
# caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
head(caravan_insurance,10)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
# caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
head(caravan_insurance,10)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
caravan_insurance$hasTwoHouses
head(caravan_insurance)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
nrow(caravan_insurance$hasTwoHouses)
head(caravan_insurance)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance, 10)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance, 10)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="yellow")
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
head(caravan_insurance, 10)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
boxplot(caravan_insurance$CARAVAN ~ caravan_insurance$hasOneHouse, xlab = "House hold", ylab = "Age", main ="Policy bought VS one house hold")
# boxplot(caravan_insurance$MAANTHUI ~ caravan_insurance$hasOneHouse, xlab = "house hold", ylab = "Age", main ="Policy bought VS one house hold")
boxplot(caravan_insurance$hasOneHouse ~ caravan_insurance$CARAVAN, xlab = "House hold", ylab = "Age", main ="Policy bought VS one house hold")
# boxplot(caravan_insurance$MAANTHUI ~ caravan_insurance$hasOneHouse, xlab = "house hold", ylab = "Age", main ="Policy bought VS one house hold")
knitr::opts_chunk$set(echo = TRUE)
# v)
boxplot(framingham$age ~ framingham$education, xlab = "education", ylab = "Age", main ="age VS education")
barplot(table(caravan_insurance$hasOneHouse),
main="Patient gender",
xlab="male",
ylab="Count",
border="black",
col="blue"
)
# boxplot(caravan_insurance$MAANTHUI ~ caravan_insurance$hasOneHouse, xlab = "house hold", ylab = "Age", main ="Policy bought VS one house hold")
head(caravan_insurance, 10)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
set = caravan_insurance
set$ORIGIN
rcorr(as.matrix(set))
set = caravan_insurance
set$ORIGIN = NULL
rcorr(as.matrix(set))
#P1 = MOSTYPE (Customer Subtype) -0.06
#P3 = MGEMOMV (Avg size household) 0.05
#P4 = MGEMLEEF (Average age) 0.00
#P5 = MOSHOOFD (Customer Main Type) -0.06
#P2 = MAANTHUI (Number of houses)  0.00
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
caravan_insurance$oldAge
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
# caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
# caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
caravan_insurance$earlyAge
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
# caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
# caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
# caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
caravan_insurance$MGEMLEEF
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
# caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
# caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
# caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
caravan_insurance[72,]
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance$earlyAge),
main="Patient gender",
xlab="male",
ylab="Count",
border="black",
col="blue"
)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance$earlyAge),
main="Patient gender",
xlab="male",
ylab="Count",
border="black",
col="blue"
)
barplot(table(caravan_insurance$middleAge),
main="Patient gender",
xlab="male",
ylab="Count",
border="black",
col="blue"
)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance$earlyAge),
main="Patient gender",
xlab="male",
ylab="Count",
border="black",
col="blue"
)
barplot(table(caravan_insurance$middleAge),
main="Patient gender",
xlab="male",
ylab="Count",
border="black",
col="blue"
)
barplot(table(caravan_insurance$oldAge),
main="Patient gender",
xlab="male",
ylab="Count",
border="black",
col="blue"
)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance$middleAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
hist(insuredRows$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
hist(insuredRows$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
set = caravan_insurance
set$ORIGIN = NULL
rcorr(as.matrix(set))
#P1 = MOSTYPE (Customer Subtype) -0.06
# customer subtype has weak corelation with response variable CARVAN so we can use for further analysis
#P3 = MGEMOMV (Avg size household) 0.05
#P4 = MGEMLEEF (Average age) 0.00
#P5 = MOSHOOFD (Customer Main Type) -0.06
#P2 = MAANTHUI (Number of houses)  0.00
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance$middleAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$middleAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
#
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$earlyAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$middleAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$oldAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
#
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$earlyAge),
main="Early age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$middleAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="pink"
)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$oldAge),
main="Old age",
xlab="age",
ylab="Count",
border="black",
col="orange"
)
# Middle age people bought most policies
knitr::opts_chunk$set(echo = TRUE)
# reading file
caravan_insurance = readr::read_csv("caravan-insurance-challenge.csv")
# training data
caravan_insurance_train = (caravan_insurance[caravan_insurance$ORIGIN == "train",])
#testing data
caravan_insurance_test = (caravan_insurance[caravan_insurance$ORIGIN == "test",])
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
set = caravan_insurance
set$ORIGIN = NULL
rcorr(as.matrix(set))
head(caravan_insurance, 10)
caravan_insurance$MAANTHUI = replace(caravan_insurance$MAANTHUI, caravan_insurance$MAANTHUI==3, 2)
caravan_insurance$hasOneHouse = ifelse(caravan_insurance$MAANTHUI ==1, 1, 0)
caravan_insurance$hasTwoHouses = ifelse(caravan_insurance$MAANTHUI ==2, 1, 0)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==1, 2)
caravan_insurance$MGEMLEEF = replace(caravan_insurance$MGEMLEEF, caravan_insurance$MGEMLEEF==5, 4)
caravan_insurance$earlyAge = ifelse(caravan_insurance$MGEMLEEF == 2, 1, 0)
caravan_insurance$middleAge = ifelse(caravan_insurance$MGEMLEEF == 3, 1, 0)
caravan_insurance$oldAge = ifelse(caravan_insurance$MGEMLEEF == 4, 1, 0)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$earlyAge),
main="Early age",
xlab="age",
ylab="Count",
border="black",
col="blue"
)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$middleAge),
main="Middle age",
xlab="age",
ylab="Count",
border="black",
col="pink"
)
barplot(table(caravan_insurance[caravan_insurance$CARAVAN == 1,]$oldAge),
main="Old age",
xlab="age",
ylab="Count",
border="black",
col="orange"
)
# Middle age people bought most policies
set = caravan_insurance
set$ORIGIN = NULL
rcorr(as.matrix(set))
# library(ggplot2)
# library(psych)
# library(corrplot)
# library(caret)
# library(glmnet)
# library(leaps)
# library(reshape2)
# library(gridExtra)
# install.packages("Hmisc")
# install.packages("pastecs")
# install.packages("ggplot2")
# install.packages("Hmisc")
library("Hmisc")
library(Hmisc)
library(pastecs)
library(ggplot2)
library(plyr)
set = caravan_insurance
set$ORIGIN = NULL
rcorr(as.matrix(set))
#P1 = MOSTYPE (Customer Subtype) -0.06
# customer subtype has weak corelation with response variable CARVAN so we can use for further analysis
#P3 = MGEMOMV (Avg size household) 0.05
#P4 = MGEMLEEF (Average age) 0.00
#P5 = MOSHOOFD (Customer Main Type) -0.06
#P2 = MAANTHUI (Number of houses)  0.00
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
hist(insuredRows$MOSHOOFD, main="Insured Customer type",
xlab = "Insured Customer type", col="blue")
# interesting insights customer with type Successful hedonists bought more policy as compare to an others, also customer with Average Family didn't buy any insurance. so company has to offer more benefits to average familes so they can buy it
hist(unInsuredRows$MOSHOOFD, main="Un Insured Customer type",
xlab = "Un Insured Customer type", col="blue")
# Family with grown ups has higher number as they didn't buy insurance at all. it might be possible they have children and other expensive so they can't afford it?
hist(caravan_insurance$MOSTYPE, main="Customer Subtype",
xlab = "Customer Subtype", col="blue")
hist(caravan_insurance$MAANTHUI, main="Number of houses",
xlab = "Number of houses", col="blue")
hist(caravan_insurance$MOSHOOFD, main="Customer Main type",
xlab = "Customer Main type", col="green")
hist(caravan_insurance$MGEMOMV, main="Average Household size",
xlab = "Average Household size", col="green")
hist(caravan_insurance$MGEMLEEF, main="Average Age",
xlab = "Average Age", col="green")
# summary of main data set
stat.desc(caravan_insurance)
summary(caravan_insurance)
# missing values in main data set
paste0("Total missing values:", sum(is.na(caravan_insurance)))
# summary of training data set
stat.desc(caravan_insurance_train)
# checking missing values in training data set
paste0("Total missing values in training:", sum(is.na(caravan_insurance_train)))
# summary of test data set
stat.desc(caravan_insurance_test)
# checking missing values in training data set
paste0("Total missing values in test:", sum(is.na(caravan_insurance_test)))
