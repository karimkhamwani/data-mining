duplicated(df)
df(duplicated(df))
df(duplicated(c(df))
df(duplicated(c(df))
```)
df(duplicated(c(df))
boxplot(df$`High level education`)
length(df >= 1)
duplicates(as.list(df))
duplicated(as.list(df))
dups = duplicated(as.list(df))
colnames(df[dups])
dups = duplicated(as.list(df))
colnames(df[dups])
sum(duplicated(df))
library(readxl)
library(purrr)
library(tidyverse)
library(dplyr)
library(plotly)
library(skimr)
library(caTools)
library(caret)
library(ROCR)
library(MASS)
df = read_excel('E:\\MSBA Mercer\\Data Mining\\Project\\Dummy data Caravan\\cardata.xlsx')
head(df)
str(df)
skim(df)
sum(is.na(df))
boxplot(df$`High level education`)
boxplot(df$`Medium level education`)
boxplot(df$`Lower level education`)
boxplot(df$`Income < 30.000`)
boxplot(df$`Income 30-45.000`)
boxplot(df$`Income 45-75.000`)
boxplot(df$`Income 75-122.000`)
boxplot(df$`Income >123.000`)
split_df = sample.split(df$`Customer main type`, SplitRatio = .6)
train_df = subset(df, split = TRUE)
test_df = subset(df, split = FALSE)
prop.table(table(train_df$`Customer main type`))
prop.table(table(test_df$`Customer main type`))
library(readxl)
library(purrr)
library(tidyverse)
library(dplyr)
library(plotly)
library(skimr)
library(caTools)
library(caret)
library(ROCR)
library(MASS)
library(ggplot2)
df = read_excel('E:\\MSBA Mercer\\Data Mining\\Project\\Dummy data Caravan\\cardata.xlsx')
head(df)
str(df)
skim(df)
sum(is.na(df))
#Not valid because the dataset is categorical
sum(duplicated(df))
sample = sample.split(df$`Customer main type`, SplitRatio = .6)
library(readxl)
library(purrr)
library(tidyverse)
library(dplyr)
library(plotly)
library(skimr)
library(caTools)
library(caret)
library(ROCR)
library(MASS)
library(ggplot2)
df = read_excel('E:\\MSBA Mercer\\Data Mining\\Project\\Dummy data Caravan\\cardata.xlsx')
head(df)
str(df)
skim(df)
sum(is.na(df))
#Not valid because the dataset is categorical
sum(duplicated(df))
sample = sample.split(df$`Customer main type`, SplitRatio = .6)
library(readxl)
library(purrr)
library(tidyverse)
library(dplyr)
library(plotly)
library(skimr)
library(caTools)
library(caret)
library(ROCR)
library(MASS)
library(ggplot2)
df = read_excel('E:\\MSBA Mercer\\Data Mining\\Project\\Dummy data Caravan\\cardata.xlsx')
head(df)
str(df)
skim(df)
sum(is.na(df))
#Not valid because the dataset is categorical
sum(duplicated(df))
sample = sample.split(df$`Customer main type`, SplitRatio = .6)
sample = sample.split(df$`Customer Subtype; see L0`, SplitRatio = .6)
test = subset(df, sample == FALSE)
train = subset(df, sample == TRUE)
dim(train)
dim(test)
ggplot(train,aes(factor(train$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Main type") +
scale_fill_discrete(name = "CARAVAN") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(test,aes(factor(test$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Main type") +
scale_fill_discrete(name = "CARAVAN") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(train$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(test,aes(factor(test$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(test,aes(factor(test$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Main Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(train$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(train$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
df$maintype = train$`Customer main type; see L2`
ggplot(train,aes(factor(train$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
train$maintype = train$`Customer main type; see L2`
nrow(train[train$`Customer Subtype; see L0` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
train$maintype = train$`Customer main type; see L2`
nrow(train[train$`Customer Subtype; see L0` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 2 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 3 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 4 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 5 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 6 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 7 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 8 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 9 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 10 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(test,aes(factor(test$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Main Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(test[train$`Customer Subtype; see L0` == 1 & test$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(test[train$`Customer main type; see L2` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(test[train$`Customer Subtype; see L0` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(train[train$`Customer Subtype; see L0` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(train[train$`Customer Subtype; see L0` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 2 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 3 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 4 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 5 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 6 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 7 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 8 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 9 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer Subtype; see L0` == 10 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(test,aes(factor(test$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(test[test$`Customer Subtype; see L0` == 1 & test$`Number of mobile home policies 0 - 1` == 1,])
ggplot(test,aes(factor(test$`Customer Subtype; see L0`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(test[test$`Customer Subtype; see L0` == 1 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 2 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 3 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 4 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 5 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 6 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 7 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 8 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 9 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer Subtype; see L0` == 10 & test$`Number of mobile home policies 0 - 1` == 1,])
ggplot(test,aes(factor(test$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Main Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(test[test$`Customer main type; see L2` == 1 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 2 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 3 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 4 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 5 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 6 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 7 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 8 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 9 & test$`Number of mobile home policies 0 - 1` == 1,])
nrow(test[test$`Customer main type; see L2` == 10 & test$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(train[train$`Customer main type; see L2` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Customer main type; see L2`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
labs(x="Customer Sub Type") +
scale_fill_discrete(name = "Mobile Insurance") +
ggtitle("Caravan Policy based on Customer Main Type") +
theme(plot.title = element_text(hjust = 0.5))
nrow(train[train$`Customer main type; see L2` == 1 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 2 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 3 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 4 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 5 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 6 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 7 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 8 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 9 & train$`Number of mobile home policies 0 - 1` == 1,])
nrow(train[train$`Customer main type; see L2` == 10 & train$`Number of mobile home policies 0 - 1` == 1,])
ggplot(train,aes(factor(train$`Avg age; see L1`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "CARAVAN") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(train$`Avg age; see L1`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(test,aes(factor(test$`Avg age; see L1`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(test,aes(factor(test$`Avg age; see L1`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
as.factor(train$`Number of houses 1 - 10`)
Houses = ifelse(train$`Number of houses 1 - 10`>1, 0,1)
Houses
Houses = ifelse(train$`Number of houses 1 - 10`>1, 0,1)
summary(Houses)
Houses = ifelse(train$`Number of houses 1 - 10`>1, 0,1)
hist(Houses)
Houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(Houses)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
plot_ly(x = houses, type = "histogram")
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
sum(houses == 1)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
sum(houses = 1)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
sum(houses = 1)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
sum(houses == 1)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
sum(houses > 1)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
sum(houses >= 1)
houses = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
houses = ifelse(test$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
ggplot(test,aes(factor(houses))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(houses))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(houses))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(houses))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(houses))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(houses))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
houses_train = ifelse(train$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
houses_test = ifelse(test$`Number of houses 1 - 10`>1, 1,0)
hist(houses)
ggplot(test,aes(factor(houses_test))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
# NOT WORKING??
ggplot(train,aes(factor(houses_train))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
household_train = ifelse(train$`Avg size household 1 - 6`> 1, 1,0)
household_test = ifelse(test$`Avg size household 1 - 6`> 1, 1,0)
ggplot(train,aes(factor(household_train))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(test,aes(factor(household_test))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(test,aes(factor(test$`Average income`))) +
geom_bar(aes(fill = factor(test$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(train,aes(factor(train$`Average income`))) +
geom_bar(aes(fill = factor(train$`Number of mobile home policies 0 - 1`))) +
geom_text(stat='count', aes(label=..count..), vjust=0) +
labs(x="Age Group") +
scale_fill_discrete(name = "Mobile Polcy") +
ggtitle("Policy bought on age group") +
theme(plot.title = element_text(hjust = 0.5))
I1 = (15000+30000)/2
I2 = (30000+45000)/2
I3 = (45000+75000)/2
I4 = (75000+122000)/2
I5 = (123000+137000)/2
I1 = (15000+30000)/2 * (1+10)/2
I2 = (30000+45000)/2
I3 = (45000+75000)/2
I4 = (75000+122000)/2
I5 = (123000+137000)/2
I1 = 0
I2 = 1-10
library(readxl)
library(purrr)
library(tidyverse)
library(dplyr)
library(plotly)
library(skimr)
library(caTools)
library(caret)
library(ROCR)
library(MASS)
library(ggplot2)
df = read_excel('E:\\MSBA Mercer\\Data Mining\\Project\\Dummy data Caravan\\cardata.xlsx')
head(df)
str(df)
skim(df)
